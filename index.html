<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Joint Clustering and Alignment of Functional Data â€¢ fdacluster</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Joint Clustering and Alignment of Functional Data">
<meta name="description" content='Implementations of the k-means, hierarchical agglomerative and DBSCAN clustering methods for functional data which allows for jointly aligning and clustering curves. It supports functional data defined on one-dimensional domains but possibly evaluating in multivariate codomains. It supports functional data defined in arrays but also via the fd and funData classes for functional data defined in the fda and funData packages respectively. It currently supports shift, dilation and affine warping functions for functional data defined on the real line and uses the SRSF framework to handle boundary-preserving warping for functional data defined on a specific interval. Main reference for the k-means algorithm: Sangalli L.M., Secchi P., Vantini S., Vitelli V. (2010) "k-mean alignment for curve clustering" &lt;doi:10.1016/j.csda.2009.12.008&gt;. Main reference for the SRSF framework: Tucker, J. D., Wu, W., &amp; Srivastava, A. (2013) "Generative models for functional data using phase and amplitude separation" &lt;doi:10.1016/j.csda.2012.12.001&gt;.'>
<meta property="og:description" content='Implementations of the k-means, hierarchical agglomerative and DBSCAN clustering methods for functional data which allows for jointly aligning and clustering curves. It supports functional data defined on one-dimensional domains but possibly evaluating in multivariate codomains. It supports functional data defined in arrays but also via the fd and funData classes for functional data defined in the fda and funData packages respectively. It currently supports shift, dilation and affine warping functions for functional data defined on the real line and uses the SRSF framework to handle boundary-preserving warping for functional data defined on a specific interval. Main reference for the k-means algorithm: Sangalli L.M., Secchi P., Vantini S., Vitelli V. (2010) "k-mean alignment for curve clustering" &lt;doi:10.1016/j.csda.2009.12.008&gt;. Main reference for the SRSF framework: Tucker, J. D., Wu, W., &amp; Srivastava, A. (2013) "Generative models for functional data using phase and amplitude separation" &lt;doi:10.1016/j.csda.2012.12.001&gt;.'>
<meta property="og:image" content="https://astamm.github.io/fdacluster/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">fdacluster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/berkeley-growth.html">Analysis of Berkeley growth data</a></li>
    <li><a class="dropdown-item" href="articles/hierarchial-clustering.html">Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="articles/input-formats.html">Supported input formats</a></li>
    <li><a class="dropdown-item" href="articles/kmeans-initialisation.html">Computing initial centroids in k-means</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://astamm.github.io/posts/2023-07-04-fdacluster-030/">fdacluster 0.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://astamm.github.io/posts/2023-05-19-fdacluster-021/">fdacluster 0.2.1</a></li>
    <li><a class="external-link dropdown-item" href="https://astamm.github.io/posts/2022-05-10-fdacluster-011/">fdacluster 0.1.1</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="news/index.html">Changelog</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-talks" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Talks</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-talks">
<li><a class="external-link dropdown-item" href="https://astamm.github.io/talks/2023-06-22-fdacluster-021/">Rencontres R 2023</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/astamm/fdacluster/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="fdacluster-">fdacluster <a class="anchor" aria-label="anchor" href="#fdacluster-"></a>
</h1>
</div>
<!-- badges: start -->

<p>The <a href="https://astamm.github.io/fdacluster/"><strong>fdacluster</strong></a> package provides implementations of the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-means, hierarchical agglomerative and DBSCAN clustering methods for functional data. Variability in functional data is intrinsically divided into three components: <em>amplitude</em>, <em>phase</em> and <em>ancillary</em> variability. The first two sources of variability can be captured with a dedicated statistical analysis that integrates a <em>curve alignment</em> step. The <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-means and HAC algorithms implemented in <a href="https://astamm.github.io/fdacluster/"><strong>fdacluster</strong></a> provide clustering structures that are based either on ampltitude variation (default behavior) or phase variation. This is achieved by jointly performing clustering and alignment of a functional data set. The three main related functions are <a href="https://astamm.github.io/fdacluster/reference/fdakmeans.html"><code>fdakmeans()</code></a> for the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-means, <a href="https://astamm.github.io/fdacluster/reference/fdahclust.html"><code>fdahclust()</code></a> for HAC and <a href="https://astamm.github.io/fdacluster/reference/fdadbscan.html"><code>fdadbscan()</code></a> for DBSCAN. The methods handle <strong>multivariate codomains</strong>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the official version from CRAN via:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"fdacluster"</span><span class="op">)</span></span></code></pre></div>
<p>or you can opt to install the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"astamm/fdacluster"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="section level3">
<h3 id="data-set">Data set<a class="anchor" aria-label="anchor" href="#data-set"></a>
</h3>
<p>Let us consider the following simulated example of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>30</mn><annotation encoding="application/x-tex">30</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>-dimensional curves: <img src="reference/figures/README-data-1.png" width="100%"></p>
<p>Looking at the data set, it seems that we shall expect <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>3</mn><annotation encoding="application/x-tex">3</annotation></semantics></math> groups if we aim at clustering based on phase variability but probably only <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math> groups if we search for a clustering structure based on amplitude variability.</p>
</div>
<div class="section level3">
<h3 id="k-means-based-on-amplitude-variability">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-means based on amplitude variability<a class="anchor" aria-label="anchor" href="#k-means-based-on-amplitude-variability"></a>
</h3>
<p>We can perform <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-means clustering based on amplitude variability as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fdakmeans.html">fdakmeans</a></span><span class="op">(</span></span>
<span>  <span class="va">simulated30</span><span class="op">$</span><span class="va">x</span>,</span>
<span>  <span class="va">simulated30</span><span class="op">$</span><span class="va">y</span>,</span>
<span>  seeds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">21</span><span class="op">)</span>,</span>
<span>  n_clusters <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  centroid_type <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  warping_class <span class="op">=</span> <span class="st">"affine"</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"normalized_l2"</span>, </span>
<span>  cluster_on_phase <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>All of <a href="https://astamm.github.io/fdacluster/reference/fdakmeans.html"><code>fdakmeans()</code></a>, <a href="https://astamm.github.io/fdacluster/reference/fdahclust.html"><code>fdahclust()</code></a> and <a href="https://astamm.github.io/fdacluster/reference/fdadbscan.html"><code>fdadbscan()</code></a> functions returns an object of class <a href="https://astamm.github.io/fdacluster/reference/caps.html"><code>caps</code></a> (for <strong>C</strong>lustering with <strong>A</strong>mplitude and <strong>P</strong>hase <strong>S</strong>eparation) for which <code>S3</code> specialized methods of <a href="https://astamm.github.io/fdacluster/reference/autoplot.caps.html"><code>ggplot2::autoplot()</code></a> and <a href="https://astamm.github.io/fdacluster/reference/plot.caps.html"><code>graphics::plot()</code></a> have been implemented. Therefore, we can visualize the results simply with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out1</span>, type <span class="op">=</span> <span class="st">"amplitude"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-kmeans-amplitude-viz-1.png" width="100%"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out1</span>, type <span class="op">=</span> <span class="st">"phase"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-kmeans-amplitude-viz-2.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="k-means-based-on-phase-variability">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-means based on phase variability<a class="anchor" aria-label="anchor" href="#k-means-based-on-phase-variability"></a>
</h3>
<p>We can perform <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-means clustering based on phase variability only by switch the <code>cluster_on_phase</code> argument to <code>TRUE</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fdakmeans.html">fdakmeans</a></span><span class="op">(</span></span>
<span>  <span class="va">simulated30</span><span class="op">$</span><span class="va">x</span>,</span>
<span>  <span class="va">simulated30</span><span class="op">$</span><span class="va">y</span>,</span>
<span>  seeds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">11</span>, <span class="fl">21</span><span class="op">)</span>,</span>
<span>  n_clusters <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  centroid_type <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  warping_class <span class="op">=</span> <span class="st">"affine"</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"normalized_l2"</span>, </span>
<span>  cluster_on_phase <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can inspect the result:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out2</span>, type <span class="op">=</span> <span class="st">"amplitude"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-kmeans-phase-viz-1.png" width="100%"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out2</span>, type <span class="op">=</span> <span class="st">"phase"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-kmeans-phase-viz-2.png" width="100%"></p>
<p>We can perform similar analyses using HAC or DBSCAN instead of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-means. The <a href="https://astamm.github.io/fdacluster/"><strong>fdacluster</strong></a> package also provides visualization tools to help choosing the optimal number of cluster based on WSS and silhouette values. This can be achieved by using a combination of the functions <a href="https://astamm.github.io/fdacluster/reference/compare_caps.html"><code>compare_caps()</code></a> and <a href="https://astamm.github.io/fdacluster/reference/plot.mcaps.html"><code>plot.mcaps()</code></a>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=fdacluster" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/astamm/fdacluster/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing fdacluster</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Aymeric Stamm <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-8725-3654" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/astamm/fdacluster/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/astamm/fdacluster/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://github.com/astamm/fdacluster/actions" class="external-link"><img src="https://github.com/astamm/fdacluster/workflows/test-coverage/badge.svg" alt="test-coverage"></a></li>
<li><a href="https://app.codecov.io/gh/astamm/fdacluster" class="external-link"><img src="https://codecov.io/gh/astamm/fdacluster/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/astamm/fdacluster/actions" class="external-link"><img src="https://github.com/astamm/fdacluster/workflows/pkgdown/badge.svg" alt="pkgdown"></a></li>
<li><a href="https://CRAN.R-project.org/package=fdacluster" class="external-link"><img src="https://www.r-pkg.org/badges/version/fdacluster" alt="CRAN status"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aymeric Stamm.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
