<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function extends hierarchical agglomerative clustering to functional
data. It includes the possibility to separate amplitude and phase
information."><title>Performs hierarchical clustering for functional data with amplitude and phase
separation — fdahclust • fdacluster</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Performs hierarchical clustering for functional data with amplitude and phase
separation — fdahclust"><meta property="og:description" content="This function extends hierarchical agglomerative clustering to functional
data. It includes the possibility to separate amplitude and phase
information."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fdacluster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/hclust.html">Hierarchical agglomerative clustering</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="external-link dropdown-item" href="https://astamm.github.io/posts/2023-05-19-fdacluster-021/">fdacluster 0.2.1</a>
    <a class="external-link dropdown-item" href="https://astamm.github.io/posts/2022-05-10-fdacluster-011/">fdacluster 0.1.1</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/astamm/fdacluster/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Performs hierarchical clustering for functional data with amplitude and phase
separation</h1>
      <small class="dont-index">Source: <a href="https://github.com/astamm/fdacluster/blob/HEAD/R/fdahclust.R" class="external-link"><code>R/fdahclust.R</code></a></small>
      <div class="d-none name"><code>fdahclust.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function extends hierarchical agglomerative clustering to functional
data. It includes the possibility to separate amplitude and phase
information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fdahclust</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_clusters <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  warping_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"affine"</span>, <span class="st">"dilation"</span>, <span class="st">"none"</span>, <span class="st">"shift"</span>, <span class="st">"srsf"</span><span class="op">)</span>,</span>
<span>  centroid_type <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"l2"</span>, <span class="st">"pearson"</span><span class="op">)</span>,</span>
<span>  linkage_criterion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"complete"</span>, <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"ward.D2"</span><span class="op">)</span>,</span>
<span>  cluster_on_phase <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use_verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  warping_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.15</span><span class="op">)</span>,</span>
<span>  maximum_number_of_iterations <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  number_of_threads <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  parallel_method <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  distance_relative_tolerance <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  use_fence <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  check_total_dissimilarity <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  compute_overall_center <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A numeric vector of length \(M\) or a numeric matrix of shape
\(N \times M\) or an object of class <code><a href="https://rdrr.io/pkg/funData/man/funData-class.html" class="external-link">funData::funData</a></code>. If a numeric
vector or matrix, it specifies the grid(s) of size \(M\) on which each of
the \(N\) curves have been observed. If an object of class
<code><a href="https://rdrr.io/pkg/funData/man/funData-class.html" class="external-link">funData::funData</a></code>, it contains the whole functional data set and the <code>y</code>
argument is not used.</p></dd>


<dt>y</dt>
<dd><p>Either a numeric matrix of shape \(N \times M\) or a numeric array
of shape \(N \times L \times M\) or an object of class <code><a href="https://rdrr.io/pkg/fda/man/fd.html" class="external-link">fda::fd</a></code>. If a
numeric matrix or array, it specifies the \(N\)-sample of
\(L\)-dimensional curves observed on grids of size \(M\). If an object
of class <code><a href="https://rdrr.io/pkg/fda/man/fd.html" class="external-link">fda::fd</a></code>, it contains all the necessary information about the
functional data set to be able to evaluate it on user-defined grids.</p></dd>


<dt>n_clusters</dt>
<dd><p>An integer value specifying the number of clusters.
Defaults to <code>1L</code>.</p></dd>


<dt>warping_class</dt>
<dd><p>A string specifying the warping class Choices are
<code>"affine"</code>, <code>"dilation"</code>, <code>"none"</code>, <code>"shift"</code> or <code>"srsf"</code>. Defaults to
<code>"affine"</code>. The SRSF class is the only class which is boundary-preserving.</p></dd>


<dt>centroid_type</dt>
<dd><p>A string specifying the type of centroid to compute.
Choices are <code>"mean"</code>, <code>"medoid"</code>, <code>"lowess"</code> or <code>"poly"</code>. Defaults to
<code>"mean"</code>. If LOWESS appproximation is chosen, the user can append an
integer between 0 and 100 as in <code>"lowess20"</code>. This number will be used as
the smoother span. This gives the proportion of points in the plot which
influence the smooth at each value. Larger values give more smoothness. The
default value is 10%. If polynomial approximation is chosen, the user can
append an positive integer as in <code>"poly3"</code>. This number will be used as the
degree of the polynomial model. The default value is <code>4L</code>.</p></dd>


<dt>metric</dt>
<dd><p>A string specifying the metric used to compare curves. Choices
are <code>"l2"</code> or <code>"pearson"</code>. Defaults to <code>"l2"</code>. Used only when
<code>warping_class != "srsf"</code>. For the boundary-preserving warping class, the
L2 distance between the SRSFs of the original curves is used.</p></dd>


<dt>linkage_criterion</dt>
<dd><p>A string specifying which linkage criterion should
be used to compute distances between sets of curves. Choices are
<code>"complete"</code> for complete linkage, <code>"average"</code> for average linkage and
<code>"single"</code> for single linkage. See <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">stats::hclust()</a></code> for more details.
Defaults to <code>"complete"</code>.</p></dd>


<dt>cluster_on_phase</dt>
<dd><p>A boolean specifying whether clustering should be
based on phase variation or amplitude variation. Defaults to <code>FALSE</code> which
implies amplitude variation.</p></dd>


<dt>use_verbose</dt>
<dd><p>A boolean specifying whether the algorithm should output
details of the steps to the console. Defaults to <code>TRUE</code>.</p></dd>


<dt>warping_options</dt>
<dd><p>A numeric vector supplied as a helper to the chosen
<code>warping_class</code> to decide on warping parameter bounds. This is used only
when <code>warping_class != "srsf"</code>.</p></dd>


<dt>maximum_number_of_iterations</dt>
<dd><p>An integer specifying the maximum number
of iterations before the algorithm stops if no other convergence criterion
was met. Defaults to <code>100L</code>.</p></dd>


<dt>number_of_threads</dt>
<dd><p>An integer value specifying the number of threads
used for parallelization. Defaults to <code>1L</code>. This is used only when
<code>warping_class != "srsf"</code>.</p></dd>


<dt>parallel_method</dt>
<dd><p>An integer value specifying the type of desired
parallelization for template computation, If <code>0L</code>, templates are computed
in parallel. If <code>1L</code>, parallelization occurs within a single template
computation (only for the medoid method as of now). Defaults to <code>0L</code>. This
is used only when <code>warping_class != "srsf"</code>.</p></dd>


<dt>distance_relative_tolerance</dt>
<dd><p>A numeric value specifying a relative
tolerance on the distance update between two iterations. If all
observations have not sufficiently improved in that sense, the algorithm
stops. Defaults to <code>1e-3</code>. This is used only when <code>warping_class != "srsf"</code>.</p></dd>


<dt>use_fence</dt>
<dd><p>A boolean specifying whether the fence algorithm should be
used to robustify the algorithm against outliers. Defaults to <code>FALSE</code>. This
is used only when <code>warping_class != "srsf"</code>.</p></dd>


<dt>check_total_dissimilarity</dt>
<dd><p>A boolean specifying whether an additional
stopping criterion based on improvement of the total dissimilarity should
be used. Defaults to <code>TRUE</code>. This is used only when <code>warping_class != "srsf"</code>.</p></dd>


<dt>compute_overall_center</dt>
<dd><p>A boolean specifying whether the overall center
should be also computed. Defaults to <code>FALSE</code>. This is used only when
<code>warping_class != "srsf"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code><a href="caps.html">caps</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The number of clusters is required as input because, with functional data,
once hierarchical clustering is performed, curves within clusters need to be
aligned to their corresponding centroid.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#----------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Extracts 15 out of the 30 simulated curves in `simulated30_sub` data set</span></span></span>
<span class="r-in"><span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">11</span><span class="op">:</span><span class="fl">15</span>, <span class="fl">21</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">simulated30_sub</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="va">idx</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">simulated30_sub</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">idx</span>, , <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#----------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Runs an HAC with affine alignment, searching for 2 clusters</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">fdahclust</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>  n_clusters <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  warping_class <span class="op">=</span> <span class="st">"affine"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Computing the distance matrix...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Calculating the tree...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Aligning all curves with respect to their centroid...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Consolidating output...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#----------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Then visualize the results</span></span></span>
<span class="r-in"><span><span class="co"># Either with ggplot2 via ggplot2::autoplot(out)</span></span></span>
<span class="r-in"><span><span class="co"># or using graphics::plot()</span></span></span>
<span class="r-in"><span><span class="co"># You can visualize the original and aligned curves with:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span>, type <span class="op">=</span> <span class="st">"amplitude"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 35 rows containing missing values (`geom_line()`).</span>
<span class="r-plt img"><img src="fdahclust-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Or the estimated warping functions with:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span>, type <span class="op">=</span> <span class="st">"phase"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fdahclust-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Aymeric Stamm.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

