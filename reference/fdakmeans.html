<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>K-Means Clustering for Functional Data with Amplitude and Phase Separation — fdakmeans • fdacluster</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="K-Means Clustering for Functional Data with Amplitude and Phase Separation — fdakmeans"><meta property="og:description" content="This function provides implementations of the k-means clustering algorithm
for functional data, with possible joint amplitude and phase separation. A
number of warping class are implemented to achieve this separation."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fdacluster</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/astamm/fdacluster/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>K-Means Clustering for Functional Data with Amplitude and Phase Separation</h1>
    <small class="dont-index">Source: <a href="https://github.com/astamm/fdacluster/blob/HEAD/R/fdakmeans.R" class="external-link"><code>R/fdakmeans.R</code></a></small>
    <div class="hidden name"><code>fdakmeans.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function provides implementations of the k-means clustering algorithm
for functional data, with possible joint amplitude and phase separation. A
number of warping class are implemented to achieve this separation.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fdakmeans</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  n_clusters <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  warping_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"affine"</span>, <span class="st">"dilation"</span>, <span class="st">"none"</span>, <span class="st">"shift"</span>, <span class="st">"srsf"</span><span class="op">)</span>,</span>
<span>  seeds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seeding_strategy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"kmeans++"</span>, <span class="st">"exhaustive-kmeans++"</span>, <span class="st">"exhaustive"</span>, <span class="st">"hclust"</span><span class="op">)</span>,</span>
<span>  maximum_number_of_iterations <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  centroid_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"medoid"</span>, <span class="st">"lowess"</span>, <span class="st">"poly"</span><span class="op">)</span>,</span>
<span>  metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"l2"</span>, <span class="st">"pearson"</span><span class="op">)</span>,</span>
<span>  warping_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.15</span><span class="op">)</span>,</span>
<span>  number_of_threads <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  parallel_method <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  distance_relative_tolerance <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  use_fence <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  check_total_dissimilarity <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use_verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  compute_overall_center <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add_silhouettes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  expand_domain <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A numeric matrix of shape \(N \times M\) specifying the grids of
size \(M\) on which each of the \(N\) curves have been observed.</p></dd>


<dt>y</dt>
<dd><p>A numeric array of shape \(N \times L \times M\) specifying the
\(N\)-sample of \(L\)-dimensional curves observed on grids of size
\(M\).</p></dd>


<dt>n_clusters</dt>
<dd><p>An integer value specifying the number of clusters.
Defaults to <code>1L</code>.</p></dd>


<dt>warping_class</dt>
<dd><p>A string specifying the warping class Choices are
<code>"affine"</code>, <code>"dilation"</code>, <code>"none"</code>, <code>"shift"</code> or <code>"srsf"</code>. Defaults to
<code>"affine"</code>. The SRSF class is the only class which is boundary-preserving.</p></dd>


<dt>seeds</dt>
<dd><p>An integer value or vector specifying the indices of the initial
centroids. If an integer vector, it is interpreted as the indices of the
intial centroids and should therefore be of length <code>n_clusters</code>. If an
integer value, it is interpreted as the index of the first initial centroid
and subsequent centroids are chosen according to the k-means++ strategy. It
can be <code>NULL</code> in which case the argument <code>seeding_strategy</code> is used to
automatically provide suitable indices. Defaults to <code>NULL</code>.</p></dd>


<dt>seeding_strategy</dt>
<dd><p>A character string specifying the strategy for
choosing the initial centroids in case the argument <code>seeds</code> is set to
<code>NULL</code>. Choices are
<a href="https://en.wikipedia.org/wiki/K-means%2B%2B" class="external-link"><code>"kmeans++"</code></a>,
<code>"exhaustive-kmeans++"</code> which performs an exhaustive search over the choice
of the first centroid, <code>"exhaustive"</code> which tries on all combinations of
initial centroids or <code>"hclust"</code> which first performs hierarchical
clustering using Ward's linkage criterion to identify initial centroids.
Defaults to <code>"kmeans++"</code>, which is the fastest strategy.</p></dd>


<dt>maximum_number_of_iterations</dt>
<dd><p>An integer specifying the maximum number
of iterations before the algorithm stops if no other convergence criterion
was met. Defaults to <code>100L</code>.</p></dd>


<dt>centroid_type</dt>
<dd><p>A string specifying the type of centroid to compute.
Choices are <code>"mean"</code> or <code>"medoid"</code>. Defaults to <code>"mean"</code>.</p></dd>


<dt>metric</dt>
<dd><p>A string specifying the metric used to compare curves.
Choices are <code>"l2"</code> or <code>"pearson"</code>. Defaults to <code>"l2"</code>. This is used only
when <code>warping_class != "srsf"</code>.</p></dd>


<dt>warping_options</dt>
<dd><p>A numeric vector supplied as a helper to the chosen
<code>warping_class</code> to decide on warping parameter bounds. This is used only
when <code>warping_class != "srsf"</code>.</p></dd>


<dt>number_of_threads</dt>
<dd><p>An integer value specifying the number of threads
used for parallelization. Defaults to <code>1L</code>. This is used only when
<code>warping_class != "srsf"</code>.</p></dd>


<dt>parallel_method</dt>
<dd><p>An integer value specifying the type of desired
parallelization for template computation, If <code>0L</code>, templates are computed
in parallel. If <code>1L</code>, parallelization occurs within a single template
computation (only for the medoid method as of now). Defaults to <code>0L</code>. This
is used only when <code>warping_class != "srsf"</code>.</p></dd>


<dt>distance_relative_tolerance</dt>
<dd><p>A numeric value specifying a relative
tolerance on the distance update between two iterations. If all
observations have not sufficiently improved in that sense, the algorithm
stops. Defaults to <code>1e-3</code>. This is used only when <code>warping_class != "srsf"</code>.</p></dd>


<dt>use_fence</dt>
<dd><p>A boolean specifying whether the fence algorithm should be
used to robustify the algorithm against outliers. Defaults to <code>FALSE</code>. This
is used only when <code>warping_class != "srsf"</code>.</p></dd>


<dt>check_total_dissimilarity</dt>
<dd><p>A boolean specifying whether an additional
stopping criterion based on improvement of the total dissimilarity should
be used. Defaults to <code>TRUE</code>. This is used only when <code>warping_class != "srsf"</code>.</p></dd>


<dt>use_verbose</dt>
<dd><p>A boolean specifying whether the algorithm should output
details of the steps to the console. Defaults to <code>TRUE</code>.</p></dd>


<dt>compute_overall_center</dt>
<dd><p>A boolean specifying whether the overall center
should be also computed. Defaults to <code>FALSE</code>. This is used only when
<code>warping_class != "srsf"</code>.</p></dd>


<dt>add_silhouettes</dt>
<dd><p>A boolean specifying whether silhouette values should
be computed for each observation for internal validation of the clustering
structure. Defaults to <code>TRUE</code>.</p></dd>


<dt>expand_domain</dt>
<dd><p>A boolean specifying how to define the within-cluster
common grids. When set to <code>FALSE</code>, the intersection of the individual
domains is used. When set to <code>TRUE</code>, the union is used and mean imputation
is performed to fill in the missing values. Defaults to <code>TRUE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code><a href="caps.html">caps</a></code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">fdakmeans</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">simulated30</span><span class="op">$</span><span class="va">x</span>,</span></span>
<span class="r-in"><span>  <span class="va">simulated30</span><span class="op">$</span><span class="va">y</span>,</span></span>
<span class="r-in"><span>  seeds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">21</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n_clusters <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  centroid_type <span class="op">=</span> <span class="st">"medoid"</span>,</span></span>
<span class="r-in"><span>  warping_class <span class="op">=</span> <span class="st">"affine"</span>,</span></span>
<span class="r-in"><span>  metric <span class="op">=</span> <span class="st">"pearson"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Information about the data set:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of observations: 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of dimensions: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of points: 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Information about cluster initialization:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of clusters: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Initial seeds for cluster centers:          1        21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Information about the methods used within the algorithm:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Warping method: affine</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Center method: medoid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Dissimilarity method: pearson</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Optimization method: bobyqa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Information about warping parameter bounds:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Warping options:    0.1500   0.1500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Information about convergence criteria:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Maximum number of iterations: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Distance relative tolerance: 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Information about parallelization setup:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of threads: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Parallel method: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Other information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Use fence to robustify: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Check total dissimilarity: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Compute overall center: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Running k-centroid algorithm:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Iteration #1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    * Size of cluster #0: 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    * Size of cluster #1: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Iteration #2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    * Size of cluster #0: 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    * Size of cluster #1: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Active stopping criteria:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Memberships did not change.</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Laura Sangalli, Piercesare Secchi, Aymeric Stamm, Simone Vantini, Valeria Vitelli.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

