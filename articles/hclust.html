<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="fdacluster">
<title>Hierarchical agglomerative clustering • fdacluster</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Hierarchical agglomerative clustering">
<meta property="og:description" content="fdacluster">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fdacluster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/hclust.html">Hierarchical agglomerative clustering</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/astamm/fdacluster/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Hierarchical agglomerative clustering</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/astamm/fdacluster/blob/HEAD/vignettes/hclust.Rmd" class="external-link"><code>vignettes/hclust.Rmd</code></a></small>
      <div class="d-none name"><code>hclust.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://astamm.github.io/fdacluster/index.html" class="external-link">fdacluster</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="theory">Theory<a class="anchor" aria-label="anchor" href="#theory"></a>
</h2>
<p>Traditional hierarchical agglomerative clustering (HAC) is usually
carried out in two mandatory steps with a third <em>optional</em>
one:</p>
<ol style="list-style-type: decimal">
<li>Compute the distance matrix <span class="math inline">\(D\)</span>
in which entry <span class="math inline">\(d_{ij}\)</span> stores the
distance between observation <span class="math inline">\(i\)</span> and
observation <span class="math inline">\(j\)</span>;</li>
<li>Compute the hierarchy of clustering structures in the form of a
dendrogram by first assuming each observation belongs to its own cluster
and progressively merge observations and groups of observations together
using a so-called <em>linkage criterion</em>;</li>
<li>[optional] Cut the tree at a given distance in order to form <span class="math inline">\(k\)</span> clusters.</li>
</ol>
<p>Each of these steps incurs slight modifications when it comes to
clustering functional data.</p>
<p><strong>Step 1.</strong> Functional HAC needs to account for the
intrinsic amplitude and phase variability inherent to functional data.
It is therefore natural when computing the distance between two curves
to minimize such a distance over all possible warping functions in a
chosen class, i.e. to integrate alignment when computing the distance
matrix. The idea is to assess how far two curves are after optimal phase
alignment. This step is achieved through the <a href="https://astamm.github.io/fdacluster/reference/fdadist.html" class="external-link"><code>fdacluster::fdadist()</code></a>.</p>
<p><strong>Step 2.</strong> The process of building up the hierarchy of
possible clustering structures does not change once the distance matrix
<span class="math inline">\(D\)</span> is known. In fact, from a
practical point of view with <code>R</code>, it is still achieved via a
call to <a href="https://rdrr.io/r/stats/hclust.html" class="external-link"><code>stats::hclust()</code></a>.
Here, the user can choose which linkage criterion to use for assessing
distances between sets of curves. For the sake of simplicity, only a
subset of choices from the <a href="https://rdrr.io/r/stats/hclust.html" class="external-link"><code>stats::hclust()</code></a>
function is actually available in <a href="https://astamm.github.io/fdacluster/" class="external-link"><strong>fdacluster</strong></a>,
namely <code>complete</code>, <code>average</code>, <code>single</code>
and <code>ward.D2</code>.</p>
<p><strong>Step 3.</strong> Once the dendrogram is built, a big
difference between multivariate HAC and functional HAC stems from the
fact that the latter requires the choice of the number of clusters,
hence making Step 3 mandatory as well. This is because, once the
grouping structure has been chosen, all the curves need to undergo a
last alignment to the centroid of the cluster they have been assigned
to. Then, and only then, within-cluster sum of squared distances to
centroid and silhouette values can be assessed. This step is achieved
through a call to <a href="https://astamm.github.io/fdacluster/reference/fdakmeans.html" class="external-link"><code>fdacluster::fdakmeans()</code></a>
with <span class="math inline">\(k = 1\)</span> and initial centroid
corresponding to the cluster medoid.</p>
</div>
<div class="section level2">
<h2 id="using-fdacluster">Using <a href="https://astamm.github.io/fdacluster/" class="external-link"><strong>fdacluster</strong></a><a class="anchor" aria-label="anchor" href="#using-fdacluster"></a>
</h2>
<p>All these steps have been enpapsulated into a single function in <a href="https://astamm.github.io/fdacluster/" class="external-link"><strong>fdacluster</strong></a>
for ease of usage:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fdahclust.html">fdahclust</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  n_clusters <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  warping_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"affine"</span>, <span class="st">"dilation"</span>, <span class="st">"none"</span>, <span class="st">"shift"</span>, <span class="st">"srsf"</span><span class="op">)</span>,</span>
<span>  centroid_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"medoid"</span>, <span class="st">"lowess"</span>, <span class="st">"poly"</span><span class="op">)</span>,</span>
<span>  metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"l2"</span>, <span class="st">"pearson"</span><span class="op">)</span>,</span>
<span>  linkage_criterion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"complete"</span>, <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"ward.D2"</span><span class="op">)</span>,</span>
<span>  cluster_on_phase <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use_verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  </span>
<span>  warping_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.15</span><span class="op">)</span>,</span>
<span>  maximum_number_of_iterations <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  number_of_threads <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  parallel_method <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  distance_relative_tolerance <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  use_fence <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  check_total_dissimilarity <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  compute_overall_center <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Laura Sangalli, Piercesare Secchi, Aymeric Stamm, Simone Vantini, Valeria Vitelli.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
