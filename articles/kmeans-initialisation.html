<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="fdacluster">
<title>Computing initial centroids in k-means • fdacluster</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Computing initial centroids in k-means">
<meta property="og:description" content="fdacluster">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fdacluster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/hierarchial-clustering.html">Hierarchical clustering</a>
    <a class="dropdown-item" href="../articles/input-formats.html">Supported input formats</a>
    <a class="dropdown-item" href="../articles/berkeley-growth.html">Analysis of Berkeley growth data</a>
    <a class="dropdown-item" href="../articles/kmeans-initialisation.html">Computing initial centroids in k-means</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="external-link dropdown-item" href="https://astamm.github.io/posts/2023-05-19-fdacluster-021/">fdacluster 0.2.1</a>
    <a class="external-link dropdown-item" href="https://astamm.github.io/posts/2022-05-10-fdacluster-011/">fdacluster 0.1.1</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/astamm/fdacluster/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Computing initial centroids in k-means</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/astamm/fdacluster/blob/HEAD/vignettes/kmeans-initialisation.Rmd" class="external-link"><code>vignettes/kmeans-initialisation.Rmd</code></a></small>
      <div class="d-none name"><code>kmeans-initialisation.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://astamm.github.io/fdacluster/index.html" class="external-link">fdacluster</a></span><span class="op">)</span></span>
<span><span class="va">true_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The <span class="math inline">\(k\)</span>-mean algorithm for both
multivariate or functional data requires an initial step in which we
select <span class="math inline">\(k\)</span> observations among our
sample to serve as initial centroids for the <span class="math inline">\(k\)</span> clusters we are looking for.</p>
<p>It is well known and reported that the outcome of the <span class="math inline">\(k\)</span>-mean algorithm is very sensitive to
this initial choice. The functional <span class="math inline">\(k\)</span>-mean algorithm implementation
<code><a href="../reference/fdakmeans.html">fdakmeans()</a></code> in the <strong>fdacluster</strong> package
includes a number of seeding strategies that automoatically set the
initial centroids which makes the outcome more robust.</p>
<div class="section level2">
<h2 id="manual-specification-of-the-initial-seeds">Manual specification of the initial seeds<a class="anchor" aria-label="anchor" href="#manual-specification-of-the-initial-seeds"></a>
</h2>
<p>You can use the optional argument <code>seeds</code> which takes in
an integer vector in which one can manually specify the indices of the
observations that will be used as initial centroids. This vector hence
needs to be of size <code>n_clusters</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_manual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fdakmeans.html">fdakmeans</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">simulated30</span><span class="op">$</span><span class="va">x</span>,</span>
<span>  y <span class="op">=</span> <span class="va">simulated30</span><span class="op">$</span><span class="va">y</span>,</span>
<span>  n_clusters <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  seeds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">21</span><span class="op">)</span>,</span>
<span>  warping_class <span class="op">=</span> <span class="st">"affine"</span>,</span>
<span>  centroid_type <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"l2"</span>,</span>
<span>  cluster_on_phase <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use_verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">out_manual</span><span class="op">$</span><span class="va">memberships</span>, <span class="va">true_groups</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">1</th>
<th align="right">2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">20</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<p>This however leads to an outcome that is very sensitive to the
initial choice in <code>seeds</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="va">initial_seeds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">2</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">outs_manual</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">initial_seeds</span>, \<span class="op">(</span><span class="va">.seeds</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/fdakmeans.html">fdakmeans</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">simulated30</span><span class="op">$</span><span class="va">x</span>,</span>
<span>      y <span class="op">=</span> <span class="va">simulated30</span><span class="op">$</span><span class="va">y</span>,</span>
<span>      n_clusters <span class="op">=</span> <span class="fl">2</span>,</span>
<span>      seeds <span class="op">=</span> <span class="va">.seeds</span>,</span>
<span>      warping_class <span class="op">=</span> <span class="st">"affine"</span>,</span>
<span>      centroid_type <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>      metric <span class="op">=</span> <span class="st">"l2"</span>,</span>
<span>      cluster_on_phase <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      use_verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Initialization <span class="op">=</span> <span class="va">initial_seeds</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_chr</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">.seeds</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">.seeds</span>, collapse <span class="op">=</span> <span class="st">","</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  `Misclassification Rate (%)` <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">outs_manual</span>, \<span class="op">(</span><span class="va">.clus</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">.clus</span><span class="op">$</span><span class="va">memberships</span>, <span class="va">true_groups</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">30</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Initialization</th>
<th align="right">Misclassification Rate (%)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">28,16</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">26,22</td>
<td align="right">30.00</td>
</tr>
<tr class="odd">
<td align="left">5,12</td>
<td align="right">36.67</td>
</tr>
<tr class="even">
<td align="left">15,9</td>
<td align="right">36.67</td>
</tr>
<tr class="odd">
<td align="left">5,6</td>
<td align="right">30.00</td>
</tr>
<tr class="even">
<td align="left">16,4</td>
<td align="right">26.67</td>
</tr>
<tr class="odd">
<td align="left">2,7</td>
<td align="right">6.67</td>
</tr>
<tr class="even">
<td align="left">22,26</td>
<td align="right">30.00</td>
</tr>
<tr class="odd">
<td align="left">6,15</td>
<td align="right">30.00</td>
</tr>
<tr class="even">
<td align="left">14,20</td>
<td align="right">6.67</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="k-means">
<span class="math inline">\(k\)</span>-means++<a class="anchor" aria-label="anchor" href="#k-means"></a>
</h2>
<p>The <span class="math inline">\(k\)</span>-means++ strategy was
originally proposed in <span class="citation">Arthur and Vassilvitskii
(2007)</span>. The algorithm is nicely described on the corresponding <a href="https://en.wikipedia.org/wiki/K-means%2B%2B" class="external-link">Wikipedia</a> page as
follows:</p>
<ol style="list-style-type: decimal">
<li>Choose one center uniformly at random among the data points.</li>
<li>For each data point <span class="math inline">\(x\)</span> not
chosen yet, compute <span class="math inline">\(D(x)\)</span>, the
distance between <span class="math inline">\(x\)</span> and the nearest
center that has already been chosen.</li>
<li>Choose one new data point at random as a new center, using a
weighted probability distribution where a point <span class="math inline">\(x\)</span> is chosen with probability proportional
to <span class="math inline">\(D(x)^2\)</span>.</li>
<li>Repeat Steps <span class="math inline">\(2\)</span> and <span class="math inline">\(3\)</span> until <span class="math inline">\(k\)</span> centers have been chosen.</li>
<li>Now that the initial centers have been chosen, proceed using
standard <span class="math inline">\(k\)</span>-means clustering.</li>
</ol>
<p>Despite the probabilistic nature of the outcome that follows from
this strategy, it provides a more robust <span class="math inline">\(k\)</span>-means procedure:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="va">outs_kpp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">10</span>, <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/fdakmeans.html">fdakmeans</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">simulated30</span><span class="op">$</span><span class="va">x</span>,</span>
<span>      y <span class="op">=</span> <span class="va">simulated30</span><span class="op">$</span><span class="va">y</span>,</span>
<span>      n_clusters <span class="op">=</span> <span class="fl">2</span>,</span>
<span>      seeding_strategy <span class="op">=</span> <span class="st">"kmeans++"</span>,</span>
<span>      warping_class <span class="op">=</span> <span class="st">"affine"</span>,</span>
<span>      centroid_type <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>      metric <span class="op">=</span> <span class="st">"l2"</span>,</span>
<span>      cluster_on_phase <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      use_verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Run <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, </span>
<span>  `Misclassification Rate (%)` <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">outs_kpp</span>, \<span class="op">(</span><span class="va">.clus</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">.clus</span><span class="op">$</span><span class="va">memberships</span>, <span class="va">true_groups</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">30</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Run</th>
<th align="right">Misclassification Rate (%)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">33.33</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="exhaustive-k-means">Exhaustive <span class="math inline">\(k\)</span>-means++<a class="anchor" aria-label="anchor" href="#exhaustive-k-means"></a>
</h2>
<p>The <span class="math inline">\(k\)</span>-means++ initialization
procedure introduces two additional sources of randomness:</p>
<ul>
<li>One for randomly picking the first centroid; and,</li>
<li>One for picking the remaining centroids based on a weighted
probability distribution.</li>
</ul>
<p>It is easy, with computational cost linear in <span class="math inline">\(N\)</span>, to get rid of the first source of
randomness by exhaustively run the <span class="math inline">\(k\)</span>-means algorithm with <span class="math inline">\(k\)</span>-means++ initialization strategy using
each observation as possible centroid for the first cluster. We call it
the exhaustive <span class="math inline">\(k\)</span>-means++
strategy:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="va">outs_ekpp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">10</span>, <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/fdakmeans.html">fdakmeans</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">simulated30</span><span class="op">$</span><span class="va">x</span>,</span>
<span>      y <span class="op">=</span> <span class="va">simulated30</span><span class="op">$</span><span class="va">y</span>,</span>
<span>      n_clusters <span class="op">=</span> <span class="fl">2</span>,</span>
<span>      seeding_strategy <span class="op">=</span> <span class="st">"exhaustive-kmeans++"</span>,</span>
<span>      warping_class <span class="op">=</span> <span class="st">"affine"</span>,</span>
<span>      centroid_type <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>      metric <span class="op">=</span> <span class="st">"l2"</span>,</span>
<span>      cluster_on_phase <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      use_verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Run <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, </span>
<span>  `Misclassification Rate (%)` <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">outs_ekpp</span>, \<span class="op">(</span><span class="va">.clus</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">.clus</span><span class="op">$</span><span class="va">memberships</span>, <span class="va">true_groups</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">30</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Run</th>
<th align="right">Misclassification Rate (%)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="exhaustive-search">Exhaustive search<a class="anchor" aria-label="anchor" href="#exhaustive-search"></a>
</h2>
<p>For completeness, it is also possible to perform an exhaustive search
although this should rarely be practical. With our simulated data of
<span class="math inline">\(N = 30\)</span> curves and looking for <span class="math inline">\(2\)</span>, this would be achieved by setting
<code>seeding_strategy = "exhaustive"</code> but would require to run
the algorithm 435 times instead of <span class="math inline">\(30\)</span> times for the exhaustive <span class="math inline">\(k\)</span>-means++ strategy which already achieves
excellent robustness performances.</p>
</div>
<div class="section level2">
<h2 id="hierarchial-clustering">Hierarchial clustering<a class="anchor" aria-label="anchor" href="#hierarchial-clustering"></a>
</h2>
<p>An alternative is to use hierarchical clustering before <span class="math inline">\(k\)</span>-means to get good initial candidates
for centroids:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fdakmeans.html">fdakmeans</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">simulated30</span><span class="op">$</span><span class="va">x</span>,</span>
<span>  y <span class="op">=</span> <span class="va">simulated30</span><span class="op">$</span><span class="va">y</span>,</span>
<span>  n_clusters <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  seeding_strategy <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  warping_class <span class="op">=</span> <span class="st">"affine"</span>,</span>
<span>  centroid_type <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"l2"</span>,</span>
<span>  cluster_on_phase <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use_verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">out_hclust</span><span class="op">$</span><span class="va">memberships</span>, <span class="va">true_groups</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">1</th>
<th align="right">2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">20</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<p>This strategy is completely deterministic. In our case, it seems to
work well. However, it will perform badly when <span class="math inline">\(k\)</span>-means clustering and hierarchial
clustering are not meant to provide the same clusters in the first
place.</p>
<p>Note that we could also implement a DBSCAN initialization strategy in
a similar fashion, with the added benefit of autotuning the number of
clusters to look for. This is not currently implemented but the user can
very well carry that out by hand. First, run <code><a href="../reference/fdadbscan.html">fdadbscan()</a></code> on
your data, which will tell you how many clusters you should search for.
Then use cluster medoids as <code>seeds</code> argument for
<code><a href="../reference/fdakmeans.html">fdakmeans()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="final-recommandations">Final recommandations<a class="anchor" aria-label="anchor" href="#final-recommandations"></a>
</h2>
<p>For functional data sets with a reasonable sample size, we recommend
to use the exhaustive <span class="math inline">\(k\)</span>-means++
strategy. For moderate to large sample sizes, we recommend to switch to
the <span class="math inline">\(k\)</span>-means++ strategy. The latter
is the current running default for <code><a href="../reference/fdakmeans.html">fdakmeans()</a></code>.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-arthur2007k" class="csl-entry">
Arthur, D., and S. Vassilvitskii. 2007. <span>“K-Means++ the Advantages
of Careful Seeding.”</span> In <em>Proceedings of the Eighteenth Annual
ACM-SIAM Symposium on Discrete Algorithms</em>, 1027–35.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Aymeric Stamm.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
