<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Supported input formats • fdacluster</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Supported input formats">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fdacluster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/berkeley-growth.html">Analysis of Berkeley growth data</a></li>
    <li><a class="dropdown-item" href="../articles/hierarchial-clustering.html">Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/input-formats.html">Supported input formats</a></li>
    <li><a class="dropdown-item" href="../articles/kmeans-initialisation.html">Computing initial centroids in k-means</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://astamm.github.io/posts/2023-07-04-fdacluster-030/">fdacluster 0.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://astamm.github.io/posts/2023-05-19-fdacluster-021/">fdacluster 0.2.1</a></li>
    <li><a class="external-link dropdown-item" href="https://astamm.github.io/posts/2022-05-10-fdacluster-011/">fdacluster 0.1.1</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-talks" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Talks</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-talks">
<li><a class="external-link dropdown-item" href="https://astamm.github.io/talks/2023-06-22-fdacluster-021/">Rencontres R 2023</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/astamm/fdacluster/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Supported input formats</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/astamm/fdacluster/blob/master/vignettes/articles/input-formats.Rmd" class="external-link"><code>vignettes/articles/input-formats.Rmd</code></a></small>
      <div class="d-none name"><code>input-formats.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://astamm.github.io/fdacluster/">fdacluster</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">#&gt;   object 'type_sum.accel' not found</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>We shall recall that <a href="https://astamm.github.io/fdacluster/index.html"><strong>fdacluster</strong></a>
handles only functional data on univariate domains. This is because
alignment (a.k.a. registration) of curves defined on multivariate
domains is much more complex. The codomain of the functional data can
however very well be multivariate. Throughout this article, we will
consistently denote:</p>
<ul>
<li>by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
the number of curves in the sample, which is the sample size;</li>
<li>by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
the size of the grids on which the curves have been evaluated;</li>
<li>by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>
the dimension of the codomain of the curves.</li>
</ul>
<div class="section level2">
<h2 id="native-format">Native format<a class="anchor" aria-label="anchor" href="#native-format"></a>
</h2>
<p>The native format in <a href="https://astamm.github.io/fdacluster/index.html"><strong>fdacluster</strong></a>
consists in a pair of vector/matrix <code>x</code> and matrix/array
<code>y</code> respectively storing the evaluation grids and the values
of the curves on these grids.</p>
<div class="section level3">
<h3 id="passing-evaluation-grids-through-the-x-argument">Passing evaluation grids through the <code>x</code> argument<a class="anchor" aria-label="anchor" href="#passing-evaluation-grids-through-the-x-argument"></a>
</h3>
<p>If all curves have been evaluated on the exact same grid, then
<code>x</code> can be either a numeric vector of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
or a numeric matrix of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">N \times M</annotation></semantics></math>,
in which case all rows should be identical.</p>
<p>It is however possible that, despite having a <em>common grid
size</em>, curves have actually been evaluated on different grids. In
this case, <code>x</code> should be a matrix of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">N \times M</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="passing-curve-values-through-the-y-argument">Passing curve values through the <code>y</code> argument<a class="anchor" aria-label="anchor" href="#passing-curve-values-through-the-y-argument"></a>
</h3>
<p>If the curves evaluate on a univariate codomain, then <code>y</code>
can be either a numeric matrix of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">N \times M</annotation></semantics></math>
or a numeric array of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>×</mo><mn>1</mn><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">N \times 1
\times M</annotation></semantics></math>. In both cases, it stores
individual curves in rows and their value on the corresponding grid
point in either the second dimension if <code>y</code> is a matrix or
the third dimension if <code>y</code> is an array.</p>
<p>It is however possible that curves evaluate on a multivariate
codomain of dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>
In this case, <code>y</code> should be an array of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>×</mo><mi>L</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">N \times L \times
M</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="parsers-for-standard-functional-r-objects">Parsers for standard functional R objects<a class="anchor" aria-label="anchor" href="#parsers-for-standard-functional-r-objects"></a>
</h2>
<p>The reason for such a choice of native format is computation
efficiency. However, the <a href="https://cran.r-project.org/view=FunctionalData" class="external-link">R landscape of
functional data analysis</a> is very rich. This has led us to make <a href="https://astamm.github.io/fdacluster/index.html"><strong>fdacluster</strong></a>
compatible with other standard ways of storing functional data in R.
Specifically, we added support for the <code>fd</code> class from the <a href="https://cran.r-project.org/package=fda" class="external-link"><strong>fda</strong></a>
package and for the <code>funData</code> and <code>multiFunData</code>
classes from the <a href="https://cran.r-project.org/package=funData" class="external-link"><strong>funData</strong></a>
package.</p>
<div class="section level3">
<h3 id="support-for-fundata">Support for <a href="https://cran.r-project.org/package=funData" class="external-link"><strong>funData</strong></a><a class="anchor" aria-label="anchor" href="#support-for-fundata"></a>
</h3>
<p>The <a href="https://cran.r-project.org/package=funData" class="external-link"><strong>funData</strong></a>
package is a package designed for the sole purpose to implement classes
for storing all kinds of functional data. Functional data have a domain
and a codomain, both of which can be univariate or multivariate. In
addition, each function in the data sample might have been observed on a
different grid. This has led the authors of the <a href="https://cran.r-project.org/package=funData" class="external-link"><strong>funData</strong></a>
package to propose three different classes, namely <span class="citation">(Happ-Kurz 2020)</span>:</p>
<blockquote>
<ol style="list-style-type: decimal">
<li>Class <code>funData</code> for dense functional data of
<em>arbitrary</em> dimension (in most cases the dimension of the domain
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">d \in \{1, 2, 3\}</annotation></semantics></math>)
on a common set of observation points
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>t</mi><mi>S</mi></msub></mrow><annotation encoding="application/x-tex">t_1, \dots, t_S</annotation></semantics></math>
for all curves. The curves may have missing values coded by
<code>NA</code>.</li>
<li>Class <code>irregFunData</code> for irregularly sampled functional
data with individual sampling points
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">t_{ij}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">j = 1, \dots, S_i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">i = 1, \dots ,N</annotation></semantics></math>
for all curves. The number
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mi>i</mi></msub><annotation encoding="application/x-tex">S_i</annotation></semantics></math>
and the location of observation points can vary across individual
observations. At the moment, only data on one-dimensional domains is
implemented.</li>
<li>Class <code>multiFunData</code> for multivariate functional data,
which combines
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
elements of functional data that may be defined on different dimensional
domains (e.g., functions and images).</li>
</ol>
</blockquote>
<p>The <a href="https://astamm.github.io/fdacluster/index.html"><strong>fdacluster</strong></a>
package focuses on functional data defined on uni-dimensional domains
with possibly multivariate codomains and possibly different evaluation
grids per curve. As such, support for all three classes is needed. This
is achieved by the utility function <code>format_inputs()</code> which
can read in classes from the <a href="https://cran.r-project.org/package=funData" class="external-link"><strong>funData</strong></a>
package when provided as <code>x</code> argument with no <code>y</code>
argument. Specifically, the following code shows how classes from the <a href="https://cran.r-project.org/package=funData" class="external-link"><strong>funData</strong></a>
package are transformed into the <code>(x, y)</code> matrix / array
format:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"funData"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">argvals</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_abort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"The {.pkg fdacluster} package does not support functional data defined "</span>,</span>
<span>      <span class="st">"on multivariate domains."</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">L</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">X</span></span>
<span>  <span class="va">dims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  <span class="va">N</span> <span class="op">&lt;-</span> <span class="va">dims</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">M</span> <span class="op">&lt;-</span> <span class="va">dims</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="va">y</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">L</span>, <span class="va">M</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">argvals</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"irregFunData"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">L</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">argvals</span><span class="op">)</span></span>
<span>  <span class="va">M</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">argvals</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">length</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">L</span>, <span class="va">M</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">y</span><span class="op">[</span>, <span class="fl">1</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">X</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/imap.html" class="external-link">imap</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">values</span>, <span class="va">id</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx</a></span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">argvals</span><span class="op">[[</span><span class="va">id</span><span class="op">]</span><span class="op">]</span>, <span class="va">values</span>, n <span class="op">=</span> <span class="va">M</span><span class="op">)</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, args <span class="op">=</span> <span class="va">_</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">argvals</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">grid</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="va">M</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, args <span class="op">=</span> <span class="va">_</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"multiFunData"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">dims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">X</span><span class="op">)</span></span>
<span>  <span class="va">grid</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">argvals</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">walk</a></span><span class="op">(</span><span class="va">x</span>, \<span class="op">(</span><span class="va">fData</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fData</span><span class="op">@</span><span class="va">argvals</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>      <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_abort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"The {.pkg fdacluster} package does not support functional data "</span>, </span>
<span>        <span class="st">"defined on multivariate domains."</span></span>
<span>      <span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">fData</span><span class="op">@</span><span class="va">argvals</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">!=</span> <span class="va">grids</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_abort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"All components of the {.cls multiFunData} object must share the same "</span>,</span>
<span>        <span class="st">"evaluation grids."</span></span>
<span>      <span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">fData</span><span class="op">@</span><span class="va">X</span><span class="op">)</span> <span class="op">!=</span> <span class="va">dims</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_abort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"All components of the {.cls multiFunData} object must have values "</span>, </span>
<span>        <span class="st">"stored in matrices with the same dimensions."</span></span>
<span>      <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="va">N</span> <span class="op">&lt;-</span> <span class="va">dims</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">M</span> <span class="op">&lt;-</span> <span class="va">dims</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">L</span>, <span class="va">M</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">l</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">L</span><span class="op">)</span> <span class="va">y</span><span class="op">[</span>, <span class="va">l</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[[</span><span class="va">l</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">X</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">grid</span></span>
<span><span class="op">}</span> <span class="kw">else</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_abort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Functional data provided in a single argument {.arg x} must be either of "</span>,</span>
<span>    <span class="st">"class {.cls funData} or of class {.cls irregFunData} or of class "</span>, </span>
<span>    <span class="st">"{.cls multiFunData}."</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="example-for-fundata-support-growth-data">Example for <code>funData</code> support: Growth Data<a class="anchor" aria-label="anchor" href="#example-for-fundata-support-growth-data"></a>
</h4>
<p>The following lines of code demonstrates how clustering functions in
<a href="https://astamm.github.io/fdacluster/index.html"><strong>fdacluster</strong></a>
handle objects of class <code>funData</code> using the Berkeley growth
data study developed in <span class="citation">Silverman and Ramsay
(2002)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">growth</span> <span class="op">&lt;-</span> <span class="fu">fda</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fda/man/growth.html" class="external-link">growth</a></span></span>
<span><span class="va">growthData</span> <span class="op">&lt;-</span> <span class="fu">funData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/funData/man/funData-class.html" class="external-link">funData</a></span><span class="op">(</span></span>
<span>  argvals <span class="op">=</span> <span class="va">growth</span><span class="op">$</span><span class="va">age</span>, </span>
<span>  X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">growth</span><span class="op">$</span><span class="va">hgtm</span>, <span class="va">growth</span><span class="op">$</span><span class="va">hgtf</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">out_growth</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fdakmeans.html">fdakmeans</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">growthData</span>,</span>
<span>  n_clusters <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  seeding_strategy <span class="op">=</span> <span class="st">"exhaustive-kmeans++"</span>,</span>
<span>  cluster_on_phase <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use_verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out_growth</span><span class="op">)</span></span></code></pre></div>
<p><img src="input-formats_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="example-for-irregfundata-support-simulated-data">Example for <code>irregFunData</code> support: Simulated Data<a class="anchor" aria-label="anchor" href="#example-for-irregfundata-support-simulated-data"></a>
</h4>
<p>The following lines of code demonstrates how clustering functions in
<a href="https://astamm.github.io/fdacluster/index.html"><strong>fdacluster</strong></a>
handle objects of class <code>irregFunData</code> using in-house
simulated data on the fly.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generates full grid</span></span>
<span><span class="va">argvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="co"># Simulate 30 irregular grids with various sampling points (number and values)</span></span>
<span><span class="va">indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">argvals</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">30</span><span class="op">:</span><span class="fl">50</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">argvalsIrreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">indices</span>, \<span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="va">argvals</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># Simulate functional data with obvious grouping structure</span></span>
<span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="va">simData</span> <span class="op">&lt;-</span> <span class="fu">funData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/funData/man/irregFunData-class.html" class="external-link">irregFunData</a></span><span class="op">(</span></span>
<span>    argvals <span class="op">=</span> <span class="va">argvalsIrreg</span>, </span>
<span>    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span></span>
<span>      <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="va">a</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="va">b</span><span class="op">)</span>, </span>
<span>      x <span class="op">=</span> <span class="va">argvalsIrreg</span>, </span>
<span>      a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span>, <span class="fl">50</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">0</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>  </span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">out_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fdakmeans.html">fdakmeans</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">simData</span>,</span>
<span>  n_clusters <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  seeding_strategy <span class="op">=</span> <span class="st">"exhaustive-kmeans++"</span>,</span>
<span>  use_verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out_sim</span><span class="op">)</span></span></code></pre></div>
<p><img src="input-formats_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="example-for-multifundata-support-gait-data">Example for <code>multiFunData</code> support: Gait Data<a class="anchor" aria-label="anchor" href="#example-for-multifundata-support-gait-data"></a>
</h4>
<p>The following lines of code demonstrates how clustering functions in
<a href="https://astamm.github.io/fdacluster/index.html"><strong>fdacluster</strong></a>
handle objects of class <code>multiFunData</code> using the gait data
study developed in <span class="citation">Silverman and Ramsay
(2002)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycle_perc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span> <span class="op">/</span> <span class="fl">19</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="va">hipData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu">fda</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fda/man/gait.html" class="external-link">gait</a></span><span class="op">[</span>, , <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">hipData</span> <span class="op">&lt;-</span> <span class="va">hipData</span></span>
<span><span class="va">kneeData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu">fda</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fda/man/gait.html" class="external-link">gait</a></span><span class="op">[</span>, , <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">kneeData</span> <span class="op">&lt;-</span> <span class="va">kneeData</span></span>
<span><span class="va">gaitData</span> <span class="op">&lt;-</span> <span class="fu">funData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/funData/man/multiFunData-class.html" class="external-link">multiFunData</a></span><span class="op">(</span></span>
<span>  <span class="fu">funData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/funData/man/funData-class.html" class="external-link">funData</a></span><span class="op">(</span>argvals <span class="op">=</span> <span class="va">cycle_perc</span>, X <span class="op">=</span> <span class="va">hipData</span><span class="op">)</span>, </span>
<span>  <span class="fu">funData</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/funData/man/funData-class.html" class="external-link">funData</a></span><span class="op">(</span>argvals <span class="op">=</span> <span class="va">cycle_perc</span>, X <span class="op">=</span> <span class="va">kneeData</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">out_gait</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fdakmeans.html">fdakmeans</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">gaitData</span>,</span>
<span>  n_clusters <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seeding_strategy <span class="op">=</span> <span class="st">"exhaustive"</span>,</span>
<span>  warping_class <span class="op">=</span> <span class="st">"srsf"</span>,</span>
<span>  use_verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">out_gait</span><span class="op">)</span></span>
<span><span class="va">p</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">component_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">component_id</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hip"</span>, <span class="st">"Knee"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Angle (degree)"</span>, title <span class="op">=</span> <span class="st">"Gait Kinematics"</span><span class="op">)</span></span></code></pre></div>
<p><img src="input-formats_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="support-for-fda">Support for <a href="https://cran.r-project.org/package=fda" class="external-link"><strong>fda</strong></a><a class="anchor" aria-label="anchor" href="#support-for-fda"></a>
</h3>
<p>The <a href="https://cran.r-project.org/package=fda" class="external-link"><strong>fda</strong></a>
package features the class <code>fd</code> as a hosting <code>R</code>
structure for functional data. In this representation, functional data
are decomposed on a number of basis functions <span class="citation">(Ramsay and Silverman 2006)</span>. The class is then a
list with the following 3 components:</p>
<ul>
<li>
<code>coefs</code>: Stores the coefficients of each functional datum
in the sample corresponding to its expansion along the basis
functions;</li>
<li>
<code>basis</code>: Stores the basis functions;</li>
<li>
<code>fdnames</code>: Stores IDs for each coefficient, each
observation and each dimension of the co-domain.</li>
</ul>
<p>Basis functions supported by the <a href="https://cran.r-project.org/package=fda" class="external-link"><strong>fda</strong></a>
package are exclusively defined on univariate domains. As such, the
class <code>fd</code> only handles functional data on unidimensional
domains. However, it accommodates functional data evaluating on
multidimensional co-domain. This is achieved by using a
three-dimensional array for the coefficients instead of a vector or a
matrix. Indeed, quoting the help page of the <code>fd</code> class:</p>
<blockquote>
<p><code>coef</code>: A vector, matrix, or three-dimensional array of
coefficients. The first dimension (or elements of a vector) corresponds
to basis functions. A second dimension corresponds to the number of
functional observations, curves or replicates. If <code>coef</code> is a
vector, it represents only a single functional observation. If
<code>coef</code> is an array, the third dimension corresponds to
variables for multivariate functional data objects. A functional data
object is <em>univariate</em> if <code>coef</code> is a vector or matrix
and <em>multivariate</em> if it is a three-dimensional array.</p>
</blockquote>
<p>Consequently, the <a href="https://astamm.github.io/fdacluster/index.html"><strong>fdacluster</strong></a>
package handles objects of class <code>fd</code> by considering that
<code>x</code>, as in native format, stores the unidimensional grids and
<code>y</code> is an object of class <code>fd</code>. It then parses the
data in the following way:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dims</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">fdnames</span>, <span class="va">length</span><span class="op">)</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="va">dims</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="va">dims</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">L</span> <span class="op">&lt;-</span> <span class="va">dims</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">is.vector</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">!=</span> <span class="va">M</span><span class="op">)</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_abort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"The number of function evaluations ({M}) does not match the grid "</span>,</span>
<span>      <span class="st">"size ({length(x)})."</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">fda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fda/man/eval.fd.html" class="external-link">eval.fd</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">!=</span> <span class="va">N</span><span class="op">)</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_abort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"When provided multiple evaluation grids as a matrix, the number of "</span>,</span>
<span>      <span class="st">"rows should match the number of curves."</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">!=</span> <span class="va">M</span><span class="op">)</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_abort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"When provided multiple evaluation grids as a matrix, the number of "</span>,</span>
<span>      <span class="st">"columns should match the common grid size."</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">fda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fda/man/eval.fd.html" class="external-link">eval.fd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">y</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># y is a single 1-dimensional curve</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="va">y</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># y is N 1-dimensional curves</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="va">y</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/aperm.html" class="external-link">aperm</a></span><span class="op">(</span><span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="example-for-fd-support-gait-data">Example for <code>fd</code> support: Gait Data<a class="anchor" aria-label="anchor" href="#example-for-fd-support-gait-data"></a>
</h4>
<p>The following lines of code demonstrates how clustering functions in
<a href="https://astamm.github.io/fdacluster/index.html"><strong>fdacluster</strong></a>
handle objects of class <code>fd</code> using the gait data study
developed in <span class="citation">Silverman and Ramsay
(2002)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bspl</span> <span class="op">&lt;-</span> <span class="fu">fda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fda/man/create.fourier.basis.html" class="external-link">create.fourier.basis</a></span><span class="op">(</span>rangeval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>, nbasis <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">gaitDataFD</span> <span class="op">&lt;-</span> <span class="fu">fda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fda/man/smooth.basis.html" class="external-link">smooth.basis</a></span><span class="op">(</span></span>
<span>  argvals <span class="op">=</span> <span class="va">cycle_perc</span>, </span>
<span>  y <span class="op">=</span> <span class="fu">fda</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fda/man/gait.html" class="external-link">gait</a></span>, </span>
<span>  fdParobj <span class="op">=</span> <span class="va">bspl</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">fd</span></span>
<span><span class="va">out_gait_fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fdakmeans.html">fdakmeans</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">cycle_perc</span>,</span>
<span>  y <span class="op">=</span> <span class="va">gaitDataFD</span>,</span>
<span>  n_clusters <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  seeding_strategy <span class="op">=</span> <span class="st">"exhaustive"</span>,</span>
<span>  warping_class <span class="op">=</span> <span class="st">"srsf"</span>,</span>
<span>  use_verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">out_gait_fd</span><span class="op">)</span></span>
<span><span class="va">p</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">component_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">component_id</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hip"</span>, <span class="st">"Knee"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Angle (degree)"</span>, title <span class="op">=</span> <span class="st">"Gait Kinematics"</span><span class="op">)</span></span></code></pre></div>
<p><img src="input-formats_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-happ2020object" class="csl-entry">
Happ-Kurz, Clara. 2020. <span>“Object-Oriented Software for Functional
Data.”</span> <em>Journal of Statistical Software</em> 93 (5): 1–38. <a href="https://doi.org/10.18637/jss.v093.i05" class="external-link">https://doi.org/10.18637/jss.v093.i05</a>.
</div>
<div id="ref-ramsay2006functional" class="csl-entry">
Ramsay, J. O., and B. W. Silverman. 2006. <em>Functional Data
Analysis</em>. Springer Series in Statistics. Springer Verlag.
</div>
<div id="ref-silverman2002applied" class="csl-entry">
Silverman, BW, and JO Ramsay. 2002. <em>Applied Functional Data
Analysis: Methods and Case Studies</em>. United States: Springer, New
York, NY.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aymeric Stamm.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
